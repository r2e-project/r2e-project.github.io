<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="description" content="R2E: Turning any GitHub Repository into a Programming Agent Environment
  " />
  <meta name="keywords"
    content="R2E, Large Language Models, LLM, Code LLM, Evaluation, Benchmark, LLM Agents, Repo Coding, Repository, SWE" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>
    R2E: Turning any GitHub Repository into a Programming Agent Environment
  </title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <!-- <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || []

      function gtag() {
        dataLayer.push(arguments)
      }

      gtag("js", new Date())

      gtag("config", "G-PYVRSFMDRL")
    </script> -->

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet" />

  <link rel="stylesheet" href="./css/bulma.min.css" />
  <link rel="stylesheet" href="./css/bulma-carousel.min.css" />
  <link rel="stylesheet" href="./css/bulma-slider.min.css" />
  <link rel="stylesheet" href="./css/fontawesome.all.min.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css" />
  <link rel="stylesheet" href="./css/index.css" />
  <link rel="icon" href="./images/favicon.svg" />

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./js/fontawesome.all.min.js"></script>
  <script src="./js/bulma-carousel.min.js"></script>
  <script src="./js/bulma-slider.min.js"></script>
  <script src="./js/index.js"></script>
</head>

<body>

  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <div class="logo-title-container" style="display: flex; align-items: center; justify-content: center;">
              <img src="./images/re.svg" alt="Logo" class="desktop-logo">
              <h1 class="title is-1 publication-title">
                <span class="dnerf">R2E</span>: Turning any <span class="dnerf">GitHub</span> Repository into a
                Programming Agent Environment
              </h1>
            </div>
            <div class="is-size-4 publication-authors">
              <span class="author-block">
                <a href="https://naman-ntc.github.io/">Naman Jain</a><sup>*</sup>,</span>
              <span class="author-block">
                <a href="https://manishs.org">Manish Shetty</a><sup>*</sup>,</span>
              <span class="author-block">
                <a href="https://tianjunz.github.io">Tianjun Zhang</a>,</span>
              <span class="author-block">
                <a href="https://kinghan.info/">King Han</a>,</span>
              <span class="author-block">
                <a href="https://people.eecs.berkeley.edu/~ksen/">Koushik Sen</a>,</span>
              <span class="author-block">
                <a href="https://people.eecs.berkeley.edu/~istoica/">Ion Stoica</a></span>
            </div>


            <div class="is-size-4 publication-authors">
              <span class="author-block">UC Berkeley</span>
            </div>

            <div class="is-size-5 publication-authors">

              <span class="author-block">
                <sup>*</sup>Equal Contribution
              </span>
            </div>
            <br />


            <div class="column has-text-centered">
              <div class="publication-links">
                <!-- PDF Link. -->
                <span class="link-block">
                  <a href="/" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                    </span>
                    <span>Paper</span>
                  </a>
                </span>
                <span class="link-block">
                  <a href="https://github.com/r2e-project/r2e"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>
                <!-- Docker image -->
                <span class="link-block">
                  <a href="https://hub.docker.com/r/namanjain12/r2e"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-docker"></i>
                    </span>
                    <span>Docker</span>
                  </a>
                  <!-- Dataset Link. -->
                  <span class="link-block">
                    <a href="/" class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                        <i class="far fa-images"></i>
                      </span>
                      <span>Data (Coming Soon!)</span>
                    </a>
                  </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="hero teaser">
    <div class="container is-max-desktop">
      <div class="hero-body">
        <div class="columns is-centered">
          <!-- center the image -->
          <img src="./images/overview.png" alt="Teaser" class="teaser-image center" width="85%" />
        </div>

        <h2 class="subtitle has-text-justified">
          Code execution is central to programming for humans and agents alike.
          However, current LLMs are trained and evaluated staticly without enabling LLMs to interact
          with developer environments that allows code execution.
          We present <span class="dnerf"><b>R2E</b></span>, a scalable framework that turns any <span
            class="dnerf">GitHub</span>
          repository into an environment for programming agents.
          These environments can be used for benchmarking programming agents that can interact with interpreter on
          repository-level problems. Further, <span class="dnerf">R2E</span> also enables collecting large-scale
          execution traces for improving LLMs themselves.
        </h2>

      </div>
    </div>
  </section>

  <section class="section">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Introduction</h2>
          <div class="content has-text-justified">
            <p>
              <span class="dnerf"><b>R2E</b></span> is a framework that turns any <span class="dnerf">GitHub</span>
              repository
              into a programming agent environment.
              This is achieved by a novel <b><i>equivalence test</i></b> generation technique powered by a synergy of
              program analysis and <span class="dnerf">LLMs</span>.
              These environments can be used for benchmarking static LLMs and dynamic programming agents that can
              interact
              with interpreter on real-world (potentially unseen) codebases.
              Furthermore, <span class="dnerf">R2E</span> environments can also be used for improving <span
                class="dnerf">LLMs</span>
              themselves by fine-tuning models with execution traces on such real-world codebases.

            </p>
          </div>
        </div>
      </div>
    </div>
  </section>


  <section class="video-teaser">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column is-four-fifths">
          <div class="video-container">
            <iframe width="700" height="395"
              src="https://www.youtube.com/embed/gjgL3TpsnlQ?si=y8RirojW7DevMXWd&autoplay=1&mute=1&loop=1&rel=0"
              title="YouTube video player" frameborder="0"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
              referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
          </div>
          <h2 class="subtitle has-text-centered">
            üëÜ See <span class="dnerf">R2E</span> turn a few <span class="dnerf">GitHub</span> repositories into a
            benchmark.
          </h2>
        </div>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Test Harness Generation: The üóùÔ∏è to Environments</h2>
          <div class="content has-text-justified">
            <span class="dnerf">R2E</span> framework generates test harnesses for any GitHub repository by leveraging
            the following key design principles
            <ul>
              <li>
                <b>Equivalence Tests, not Output Prediction.</b> R2E decouples input generation from output
                prediction by generating equivalence tests that use the <i>ground truth</i> function implementation to
                generate test cases - a much simpler task than predicting the output of a function.
              </li>
              <li>
                <b>Harnesses, not I/O Pairs.</b> R2E generates test harnesses that contain the test cases along with a
                setup which prepares additional information like database connections, external files, configurations,
                etc. This is a deparature from I/O examples with primitive types in traditional benchmarks.
              </li>
              <li>
                <b>Sliced Context, not Entire Repositories.</b> R2E uses a novel dependecy slicing based prompt
                construction approach which provides the minimal repository context requires to <i>understand</i> the
                function implementation. Emperically, we find it to be both cheaper and more effective than using the
                entire repository context.
              </li>
              <li>
                <b>Execution and Coverage for Quality.</b> The generated test harnesses are run in a self-equivalence
                mode to filter wrong or stochastic tests. Additionally, we evaluate the quality of the
                generated tests using branch coverage.
              </li>

            </ul>
            <br />
            The following figure depicts an example test harness generated by <span class="dnerf">R2E</span>.
            <img src="./images/example.png" alt="Test Generation" class="teaser-image center" width="100%"
              height="90%" />

            We evaluate the quality of the generated test harnesses by comparing the validity and coverage of the
            generated tests. Following table compares the quality of the generated tests for a simple output prediction
            setting against our equivalence test generation setting. As we see, the equivalence tests achieve better
            validty due to the decoupling of input generation from output prediction. We study different context
            creation approaches and find that sliced context is the most effective (see paper for details).

            <table>
              <thead>
                <tr>
                  <th colspan="2"></th>
                  <th colspan="2" style="text-align: center;"><strong>In-File</strong></th>
                  <th colspan="2" style="text-align: center;"><strong>Out-File</strong></th>
                </tr>
                <tr>
                  <th colspan="2" style="text-align: center;"><strong>Strategy</strong></th>
                  <th style="text-align: center;"><strong>Val</strong></th>
                  <th style="text-align: center;"><strong>Cov</strong></th>
                  <th style="text-align: center;"><strong>Val</strong></th>
                  <th style="text-align: center;"><strong>Cov</strong></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="2" style="text-align: center;"><strong>Output Pred.</strong></td>
                  <td style="text-align: center;">35.43%</td>
                  <td style="text-align: center;">87.59%</td>
                  <td style="text-align: center;">30.68%</td>
                  <td style="text-align: center;">82.54%</td>
                </tr>
                <tr>
                  <td colspan="2" style="text-align: center;"><strong>Equivalence</strong></td>

                  <td style="text-align: center;">52.37%</td>
                  <td style="text-align: center;">88.18%</td>
                  <td style="text-align: center;">35.01%</td>
                  <td style="text-align: center;">79.65%</td>
                </tr>
              </tbody>
            </table>


            <!-- <table>
              <thead>
                <tr>
                  <th colspan="2"></th>
                  <th colspan="2" style="text-align: center;"><strong>In-File</strong></th>
                  <th colspan="2" style="text-align: center;"><strong>Out-File</strong></th>
                </tr>
                <tr>
                  <th colspan="2" style="text-align: center;"><strong>Strategy</strong></th>
                  <th style="text-align: center;"><strong>Val</strong></th>
                  <th style="text-align: center;"><strong>Cov</strong></th>
                  <th style="text-align: center;"><strong>Val</strong></th>
                  <th style="text-align: center;"><strong>Cov</strong></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="2" style="text-align: center;"><strong>Output Pred.</strong></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                </tr>
                <tr>
                  <td></td>
                  <td style="text-align: center;"><strong>Sliced</strong></td>
                  <td style="text-align: center;">35.43%</td>
                  <td style="text-align: center;">87.59%</td>
                  <td style="text-align: center;">30.68%</td>
                  <td style="text-align: center;">82.54%</td>
                </tr>
                <tr>
                  <td colspan="2" style="text-align: center;"><strong>Equivalence</strong></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                </tr>
                <tr>
                  <td></td>
                  <td style="text-align: center;"><strong>Na\"ive</strong></td>
                  <td style="text-align: center;">44.25%</td>
                  <td style="text-align: center;">87.96%</td>
                  <td style="text-align: center;">19.82%</td>
                  <td style="text-align: center;">76.59%</td>
                </tr>
                <tr>
                  <td></td>
                  <td style="text-align: center;"><strong>Full</strong></td>
                  <td style="text-align: center;">51.73%</td>
                  <td style="text-align: center;">87.32%</td>
                  <td style="text-align: center;">32.24%</td>
                  <td style="text-align: center;">77.23%</td>
                </tr>
                <tr>
                  <td></td>
                  <td style="text-align: center;"><strong>Sliced</strong></td>
                  <td style="text-align: center;"><strong>52.37%</strong></td>
                  <td style="text-align: center;"><strong>88.18%</strong></td>
                  <td style="text-align: center;"><strong>35.01%</strong></td>
                  <td style="text-align: center;"><strong>79.65%</strong></td>
                </tr>
              </tbody>
            </table> -->


          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Evaluating Real-world Code Generation</h2>
          <div class="content has-text-justified">
            R2E environments enable evaluating code generation systems. Particularly, we can evaluate both single
            round "static" code generation from <span class="dnerf">LLMs</span> and multi-round programming agents. We
            construct <span class="dnerf"><b>R2E-Eval1</b></span>, a
            large scale benchmark spanning 137 repositories that can be used to evaluate code generation systems.
            The figure on the bottom left compares single round performance of current LLMs and on the bottom right
            depicts performance of self-repair agents over multiple rounds.
            <div class="columns is-centered" style="padding-top:2em;">
              <img src="./images/model_perfs.png" alt="Pass@1 on R2E-Eval1" class="teaser-image" width="47%"
                height="47%" />
              <div style="width: 5%;"></div>
              <img src="./images/repair_rate.png" alt="Repair Rate on R2E-Eval1" class="teaser-image" width="40%"
                height="25%" />
            </div>
            As we see, model performances on <span class="dnerf"><b>R2E-Eval1</b></span> are considerably lower than
            traditional benchmarks like <span class="dnerf">HumanEval</span> highlighting the challenges of real-world
            codebases.
            Next, we find that self-repair agents can
            significantly improve the performance of LLMs using oracle mistake feedback and compiler interactions over
            multiple
            turns. GPT-4 can fix more than 30% of the mistakes after 3 turns!

            We will release a larger and more challenging benchmark (<span class="dnerf"><b>R2E-Eval2</b></span>) soon
            with more detailed results. Stay tuned!
          </div>
        </div>
      </div>

    </div>
  </section>


  <section class="video-teaser" style="padding-bottom:4%">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column is-four-fifths">
          <h3 class="title has-text-centered">Beyond Code Generation with Environments</h3>
          <span class="dnerf">R2E</span> environments enable applications beyond code generation.
          Powered by <b>equivalence tests</b>, R2E can inherently verify program transformations
          such as code optimizations, refactoring, and transpilation. These tests simply check if the
          transformed version of code is equivalent to the original code under a set of automatically generated
          high-coverage test cases. Below we demonstrate how <span class="dnerf">R2E</span> environments can be used to
          optimize code in real-world:

          <div class="video-container" style="padding-top:1em;">
            <iframe width="700" height="395"
              src="https://www.youtube.com/embed/NrTEbwyofAg?si=cdQhFovqMAPnS8ya&autoplay=1&mute=1&loop=1&rel=0"
              title="YouTube video player" frameborder="0"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
              referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
          </div>
          Here, we show an demo of how a programming agent optimizes code in an arbitrary Python repository
          (<a href="https://github.com/AtsushiSakai/PythonRobotics">PythonRobotics</a>).
          R2E enables this by first building an environment for the repository and generating <b>equivalence tests</b>
          that verifies if the agent's code changes are correct. The agent then interacts with the environment to
          optimize the code by 1.8x üöÄ!
        </div>
      </div>
    </div>
  </section>

  <section class="video-teaser">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column is-four-fifths">
          <div class="video-container">
            <iframe width="700" height="395"
              src="https://www.youtube.com/embed/4Ysk9IDy8-w?si=6qlGRMtJiHLBoTZX&autoplay=1&mute=1&loop=1&rel=0"
              title="YouTube video player" frameborder="0"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
              referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
          </div>
          In an a more complex example, we show an agent optimizing a method from <b>R2E's own repository</b>!!
          <i>In fact, this was an optimization opportunity suggested in our code review!</i>
          Again, R2E scales to arbitrary repositories and generates <b>high coverage</b> equivalence tests for functions
          and methods. R2E additionally simplifies the execution of generated or edited code from LLMs in a repository
          setting.
          Failing equivalence tests provide feedback for the agent to attempt multiple rounds
          to reach the optimal solution, speedups upto 239x on <i>adversarial performance</i> tests!
        </div>
      </div>
    </div>
  </section>





  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>@inproceedings{
    jain2024r2e,
    title={R2E: Turning any Github Repository into a Programming Agent Test Environment},
    author={Naman Jain and Manish Shetty and Tianjun Zhang and King Han and Koushik Sen and Ion Stoica},
    booktitle={},
    year={2024},
    url={https://openreview.net/forum?id=xsytkViOsd}
}</code></pre>
    </div>
  </section>

  <footer class="footer">
    <div class="container">

      <div class="columns is-centered">
        <div class="column is-8">
          <div class="content">
            <p>
              Please reach out to <a href="mailto:naman_jain@berkeley.edu">naman_jain@berkeley.edu</a> or
              <a href="mailto:manishs@berkeley.edu">manishs@berkeley.edu</a> for any questions or feedback on R2E.
              We are looking forward to collaborations.
            </p>
            <p>
              The source code from this website is borrowed from <a
                href="https://github.com/nerfies/nerfies.github.io">this template</a>!
            </p>
          </div>
        </div>
      </div>
    </div>
  </footer>
</body>

</html>